// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Consents {
  consentId            String   @id
  cpf                  String
  cnpj                 String?
  creationDateTime     DateTime @default(now())
  statusUpdateDateTime DateTime @updatedAt
  ispbDebtor           String
  issuerDebtor         String
  numberDebtor         String
  accountTypeDebtor    String
  ispbCreditor         String?
  issuerCreditor       String?
  numberCreditor       String?
  accountTypeCreditor  String?

  @@map("consents")
}

model Payments {
  paymentId                 String      @id @default(auto()) @map("_id") @db.ObjectId
  consentId                 String
  pixId                     String
  endToEndId                String
  creationDateTime          DateTime    @default(now())
  statusUpdateDateTime      DateTime    @updatedAt
  proxy                     String
  ibgeTownCode              String
  status                    String
  localInstrument           String
  cnpjInitiator             String
  amount                    String
  currency                  String
  transactionIdentification String?
  remittanceInformation     String
  authorisationFlow         String?
  ispbDebtor                String
  issuerDebtor              String
  numberDebtor              String
  accountTypeDebtor         String
  ispbCreditor              String
  issuerCreditor            String
  numberCreditor            String
  accountTypeCreditor       String
  qrCode                    String?
  scheduleType              String? // Tipo de agendamento: single, daily, weekly, monthly, custom
  scheduleStartDate         DateTime? // Data de início do agendamento
  scheduleQuantity          Int? // Quantidade de pagamentos agendados
  scheduleDayOfWeek         String? // Dia da semana para agendamentos semanais
  scheduleDayOfMonth        Int? // Dia do mês para agendamentos mensais
  scheduleCustomDates       DateTime[]? // Datas personalizadas para agendamentos personalizados
  scheduleAdditionalInfo    String? // Informações adicionais sobre o agendamento
  code                      String?
  detail                    String?
  reason                    String?
  cancelledFrom             String?
  cancelledAt               DateTime?   @default(now())
  cancelledByIdentification String?
  cancelledByRel            String?

  @@map("payments")
}

model RecurringConsents {
  recurringConsentId   String   @id
  cpf                  String
  cnpj                 String?
  creationDateTime     DateTime @default(now())
  statusUpdateDateTime DateTime @updatedAt
  proxy                String
  ispbDebtor           String
  issuerDebtor         String
  numberDebtor         String
  accountTypeDebtor    String
  ispbCreditor         String?
  issuerCreditor       String?
  numberCreditor       String?
  accountTypeCreditor  String?

  @@map("recurringConsents")
}

model AutomaticPayments {
  recurringPaymentId                    String    @id @default(uuid())
  recurringConsentId                    String    @unique
  endToEndId                            String
  date                                  String
  creationDateTime                      DateTime  @default(now())
  statusUpdateDateTime                  DateTime  @updatedAt
  proxy                                 String
  ibgeTownCode                          String
  status                                String
  cnpjInitiator                         String
  paymentAmount                         String
  paymentCurrency                       String
  transactionIdentification             String
  remittanceInformation                 String
  authorisationFlow                     String
  qrCode                                String?
  rejectionCode                         String?
  rejectionDetail                       String?
  cancellationReason                    String?
  cancellationCancelledFrom             String?
  cancellationCancelledAt               DateTime? @default(now())
  cancellationCancelledByIdentification String?
  cancellationCancelledByRel            String?

  @@map("automaticPayments")
}
